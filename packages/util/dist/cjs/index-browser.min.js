!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("big-integer")):"function"==typeof define&&define.amd?define(["exports","big-integer"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).IotaUtil={},t.bigInt)}(this,(function(t,e){"use strict";function r(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var n=r(e);class s{static generate(t){return s.randomPolyfill?s.randomPolyfill(t):new Uint8Array(t)}}s.randomPolyfill||(s.randomPolyfill=t=>{const e=new Uint8Array(t);return window.crypto.getRandomValues(e),e});class i{static decode(t){let e=0,r=0;t=t.replace(/=+$/,"");let n=0;const s=new Uint8Array(Math.trunc(5*t.length/8));for(let a=0;a<t.length;a++){const o=i._ALPHABET.indexOf(t[a]);if(-1===o)throw new Error(`"Invalid character found '${t[a]}'`);r=r<<5|o,e+=5,e>=8&&(s[n++]=r>>>e-8&255,e-=8)}return s}static encode(t){let e=0,r=0,n="";for(let s=0;s<t.byteLength;s++)for(r=r<<8|t[s],e+=8;e>=5;)n+=i._ALPHABET[r>>>e-5&31],e-=5;for(e>0&&(n+=i._ALPHABET[r<<5-e&31]);n.length%8!=0;)n+="=";return n}}i._ALPHABET="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";class a{static decode(t){let e=0;for(let r=0;r<t.length&&"1"===t[r];r++)e+=1;const r=Math.trunc(733*t.length/1e3)+1,n=r<=128?new Uint8Array(128).fill(0):Buffer.alloc(r);let s=0;for(let i=e;i<t.length;i++){const e=t.charCodeAt(i);if(65408&e)throw new Error(`"Invalid character found '${e}'`);const o=a._ALPHABET_REVERSE[e];if(-1===o)throw new Error(`"Invalid character found '${e}'`);let h=o,d=0;for(let t=r-1;t>=0&&!(0===h&&d>=s);t--,d++)h+=58*n[t],n[t]=h,h>>>=8;s=d}const i=new Uint8Array(e+s);let o;for(o=0;o<e;o++)i[o]=0;let h=r-s;for(;h<r;)i[o++]=n[h++];return i}static encode(t){let e=0;for(let r=0;r<t.length&&0===t[r];r++)e+=1;const r=Math.trunc(138*(t.length-e)/100)+1,n=r<=128?new Uint8Array(128).fill(0):Buffer.alloc(r);let s=0;for(let i=e;i<t.length;i++){let e=t[i],a=0;for(let t=r-1;t>=0&&!(0===e&&a>=s);t--,a++)e+=256*n[t],n[t]=e%58,e=Math.trunc(e/58);s=a}let i=r-s;for(;i<r&&0===n[i];)i+=1;let o="";for(let t=0;t<e;t++)o+="1";for(;i<r;)o+=a._ALPHABET[n[i++]];return o}}a._ALPHABET="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",a._ALPHABET_REVERSE=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,-1,-1,-1,-1,-1,-1,-1,9,10,11,12,13,14,15,16,-1,17,18,19,20,21,-1,22,23,24,25,26,27,28,29,30,31,32,-1,-1,-1,-1,-1,-1,33,34,35,36,37,38,39,40,41,42,43,-1,44,45,46,47,48,49,50,51,52,53,54,55,56,57,-1,-1,-1,-1,-1];class o{static byteLength(t){const e=o.getLengths(t);return o.calcByteLength(e[0],e[1])}static decode(t){let e;const r=o.getLengths(t),n=r[0],s=r[1],i=new Uint8Array(o.calcByteLength(n,s));let a=0;const h=s>0?n-4:n;let d;for(d=0;d<h;d+=4)e=o._REVERSE_LOOKUP[t.charCodeAt(d)]<<18|o._REVERSE_LOOKUP[t.charCodeAt(d+1)]<<12|o._REVERSE_LOOKUP[t.charCodeAt(d+2)]<<6|o._REVERSE_LOOKUP[t.charCodeAt(d+3)],i[a++]=e>>16&255,i[a++]=e>>8&255,i[a++]=255&e;return 2===s&&(e=o._REVERSE_LOOKUP[t.charCodeAt(d)]<<2|o._REVERSE_LOOKUP[t.charCodeAt(d+1)]>>4,i[a++]=255&e),1===s&&(e=o._REVERSE_LOOKUP[t.charCodeAt(d)]<<10|o._REVERSE_LOOKUP[t.charCodeAt(d+1)]<<4|o._REVERSE_LOOKUP[t.charCodeAt(d+2)]>>2,i[a++]=e>>8&255,i[a++]=255&e),i}static encode(t){let e;const r=t.length,n=r%3,s=[],i=16383;for(let e=0,a=r-n;e<a;e+=i)s.push(o.encodeChunk(t,e,e+i>a?a:e+i));return 1===n?(e=t[r-1],s.push(`${o._LOOKUP[e>>2]+o._LOOKUP[e<<4&63]}==`)):2===n&&(e=(t[r-2]<<8)+t[r-1],s.push(`${o._LOOKUP[e>>10]+o._LOOKUP[e>>4&63]+o._LOOKUP[e<<2&63]}=`)),s.join("")}static calcByteLength(t,e){return 3*(t+e)/4-e}static getLengths(t){const e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");let r=t.indexOf("=");-1===r&&(r=e);return[r,r===e?0:4-r%4]}static tripletToBase64(t){return o._LOOKUP[t>>18&63]+o._LOOKUP[t>>12&63]+o._LOOKUP[t>>6&63]+o._LOOKUP[63&t]}static encodeChunk(t,e,r){let n;const s=[];for(let i=e;i<r;i+=3)n=(t[i]<<16&16711680)+(t[i+1]<<8&65280)+(255&t[i+2]),s.push(o.tripletToBase64(n));return s.join("")}}o._LOOKUP="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o._REVERSE_LOOKUP={43:62,45:62,47:63,48:52,49:53,50:54,51:55,52:56,53:57,54:58,55:59,56:60,57:61,65:0,66:1,67:2,68:3,69:4,70:5,71:6,72:7,73:8,74:9,75:10,76:11,77:12,78:13,79:14,80:15,81:16,82:17,83:18,84:19,85:20,86:21,87:22,88:23,89:24,90:25,95:63,97:26,98:27,99:28,100:29,101:30,102:31,103:32,104:33,105:34,106:35,107:36,108:37,109:38,110:39,111:40,112:41,113:42,114:43,115:44,116:45,117:46,118:47,119:48,120:49,121:50,122:51};class h{static read3(t,e){const r=t[e+0]+(t[e+1]<<8)+(t[e+2]<<16)>>>0;return n.default(r)}static read4(t,e){const r=t[e+0]+(t[e+1]<<8)+(t[e+2]<<16)+(t[e+3]<<24)>>>0;return n.default(r)}static read8(t,e){const r=t[e+0]+(t[e+1]<<8)+(t[e+2]<<16)+(t[e+3]<<24)>>>0,s=t[e+4]+(t[e+5]<<8)+(t[e+6]<<16)+(t[e+7]<<24)>>>0;return n.default(s).shiftLeft(h.BIG_32).or(r)}static write8(t,e,r){const n=Number(t.and(h.BIG_32_MASK)),s=Number(t.shiftRight(h.BIG_32).and(h.BIG_32_MASK));e[r]=255&n,e[r+1]=n>>8&255,e[r+2]=n>>16&255,e[r+3]=n>>24&255,e[r+4]=255&s,e[r+5]=s>>8&255,e[r+6]=s>>16&255,e[r+7]=s>>24&255}static random(){return h.read8(s.generate(8),0)}}h.BIG_32=n.default(32),h.BIG_32_MASK=n.default(4294967295);class d{static bytesToUtf8(t,e,r){const n=null!=e?e:0,s=null!=r?r:t.length;let i="";for(let e=n;e<n+s;e++){const r=t[e];if(r<128)i+=String.fromCharCode(r);else if(r>191&&r<224)i+=String.fromCharCode((31&r)<<6|63&t[e+1]),e+=1;else if(r>223&&r<240)i+=String.fromCharCode((15&r)<<12|(63&t[e+1])<<6|63&t[e+2]),e+=2;else{const n=((7&r)<<18|(63&t[e+1])<<12|(63&t[e+2])<<6|63&t[e+3])-65536;i+=String.fromCharCode(n>>10|55296,1023&n|56320),e+=3}}return i}static utf8ToBytes(t){const e=[];for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);n<128?e.push(n):n<2048?e.push(192|n>>6,128|63&n):n<55296||n>=57344?e.push(224|n>>12,128|n>>6&63,128|63&n):(r++,n=65536+((1023&n)<<10|1023&t.charCodeAt(r)),e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n))}return Uint8Array.from(e)}static bytesToHex(t,e,r,n){let s="";if(this.buildHexLookups(),d.ENCODE_LOOKUP){const i=null!=r?r:t.length,a=null!=e?e:0;if(n)for(let e=0;e<i;e++)s=d.ENCODE_LOOKUP[t[a+e]]+s;else for(let e=0;e<i;e++)s+=d.ENCODE_LOOKUP[t[a+e]]}return s}static hexToBytes(t,e){const r=t.length>>1,n=r<<1,s=new Uint8Array(r);if(this.buildHexLookups(),d.DECODE_LOOKUP){let r=0,i=0;for(;r<n;)s[i++]=d.DECODE_LOOKUP[t.charCodeAt(r++)]<<4|d.DECODE_LOOKUP[t.charCodeAt(r++)];e&&s.reverse()}return s}static utf8ToHex(t){return d.bytesToHex(d.utf8ToBytes(t))}static hexToUtf8(t){return d.bytesToUtf8(d.hexToBytes(t))}static isHex(t){return t.length%2!=1&&/^[\da-f]+$/g.test(t)}static bytesToBinary(t){const e=[];for(let r=0;r<t.length;r++)e.push(t[r].toString(2).padStart(8,"0"));return e.join("")}static binaryToBytes(t){const e=new Uint8Array(Math.ceil(t.length/8));for(let r=0;r<e.length;r++)e[r]=Number.parseInt(t.slice(8*r,8*(r+1)),2);return e}static bytesToBase64(t){return o.encode(t)}static base64ToBytes(t){return o.decode(t)}static buildHexLookups(){if(!d.ENCODE_LOOKUP||!d.DECODE_LOOKUP){const t="0123456789abcdef";d.ENCODE_LOOKUP=[],d.DECODE_LOOKUP=[];for(let e=0;e<256;e++)d.ENCODE_LOOKUP[e]=t[e>>4&15]+t[15&e],e<16&&(e<10?d.DECODE_LOOKUP[48+e]=e:d.DECODE_LOOKUP[87+e]=e)}}}class l{constructor(){this._storage=new Uint8Array(l.CHUNK_SIZE),this._writeIndex=0}length(){return this._storage.length}unused(){return this._storage.length-this._writeIndex}finalBytes(){return this._storage.subarray(0,this._writeIndex)}finalHex(){return d.bytesToHex(this._storage.subarray(0,this._writeIndex))}getWriteIndex(){return this._writeIndex}setWriteIndex(t){if(this._writeIndex=t,t>=this._storage.length)throw new Error(`You cannot set the writeIndex to ${t} as the stream is only ${this._storage.length} in length`)}writeFixedHex(t,e,r){if(!d.isHex(r))throw new Error(`The ${t} should be in hex format`);if(2*e!==r.length)throw new Error(`${t} length ${r.length} does not match expected length ${2*e}`);this.expand(e),this._storage.set(d.hexToBytes(r),this._writeIndex),this._writeIndex+=e}writeBytes(t,e,r){this.expand(e),this._storage.set(r,this._writeIndex),this._writeIndex+=e}writeByte(t,e){this.expand(1),this._storage[this._writeIndex++]=255&e}writeUInt16(t,e){this.expand(2),this._storage[this._writeIndex++]=255&e,this._storage[this._writeIndex++]=e>>>8}writeUInt32(t,e){this.expand(4),this._storage[this._writeIndex++]=255&e,this._storage[this._writeIndex++]=e>>>8,this._storage[this._writeIndex++]=e>>>16,this._storage[this._writeIndex++]=e>>>24}writeUInt64(t,e){this.expand(8),h.write8(e,this._storage,this._writeIndex),this._writeIndex+=8}writeBoolean(t,e){this.expand(1),this._storage[this._writeIndex++]=e?1:0}expand(t){if(this._writeIndex+t>this._storage.byteLength){const e=new Uint8Array(this._storage.length+Math.ceil(t/l.CHUNK_SIZE)*l.CHUNK_SIZE);e.set(this._storage,0),this._storage=e}}}l.CHUNK_SIZE=4096,t.Base32=i,t.Base58=a,t.Base64=o,t.BigIntHelper=h,t.Converter=d,t.RandomHelper=s,t.ReadStream=class{constructor(t,e=0){this._storage=new Uint8Array(t),this._readIndex=e}length(){return this._storage.byteLength}hasRemaining(t){return this._readIndex+t<=this._storage.byteLength}unused(){return this._storage.byteLength-this._readIndex}getReadIndex(){return this._readIndex}setReadIndex(t){if(this._readIndex=t,t>=this._storage.length)throw new Error(`You cannot set the readIndex to ${t} as the stream is only ${this._storage.length} in length`)}readFixedHex(t,e,r=!0){if(!this.hasRemaining(e))throw new Error(`${t} length ${e} exceeds the remaining data ${this.unused()}`);const n=d.bytesToHex(this._storage,this._readIndex,e);return r&&(this._readIndex+=e),n}readBytes(t,e,r=!0){if(!this.hasRemaining(e))throw new Error(`${t} length ${e} exceeds the remaining data ${this.unused()}`);const n=this._storage.slice(this._readIndex,this._readIndex+e);return r&&(this._readIndex+=e),n}readByte(t,e=!0){if(!this.hasRemaining(1))throw new Error(`${t} length 1 exceeds the remaining data ${this.unused()}`);const r=this._storage[this._readIndex];return e&&(this._readIndex+=1),r}readUInt16(t,e=!0){if(!this.hasRemaining(2))throw new Error(`${t} length 2 exceeds the remaining data ${this.unused()}`);const r=this._storage[this._readIndex]|this._storage[this._readIndex+1]<<8;return e&&(this._readIndex+=2),r}readUInt32(t,e=!0){if(!this.hasRemaining(4))throw new Error(`${t} length 4 exceeds the remaining data ${this.unused()}`);const r=this._storage[this._readIndex]|256*this._storage[this._readIndex+1]|65536*this._storage[this._readIndex+2]+16777216*this._storage[this._readIndex+3];return e&&(this._readIndex+=4),r}readUInt64(t,e=!0){if(!this.hasRemaining(8))throw new Error(`${t} length 8 exceeds the remaining data ${this.unused()}`);const r=h.read8(this._storage,this._readIndex);return e&&(this._readIndex+=8),r}readBoolean(t,e=!0){if(!this.hasRemaining(1))throw new Error(`${t} length 1 exceeds the remaining data ${this.unused()}`);const r=this._storage[this._readIndex];return e&&(this._readIndex+=1),0!==r}},t.WriteStream=l,Object.defineProperty(t,"__esModule",{value:!0})}));